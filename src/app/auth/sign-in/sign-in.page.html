<ion-content class="sign-in--page-container" class="no-keyboard-adjust">
  <div class="sign-in__select-sign-in" *ngIf="currentStep === signInPageState.SELECT_SIGN_IN_METHOD">
    <video
      class="sign-in__video-container sign-in__video-container__video"
      width="100%"
      height="auto"
      onloadedmetadata="this.muted = true"
      oncanplay="this.play()"
      loop
    >
      <source src="/assets/videos/mobile-onboarding.mp4" type="video/mp4" />
    </video>
  </div>
  <div class="sign-in__cta-container" *ngIf="currentStep === signInPageState.SELECT_SIGN_IN_METHOD">
    <ion-button (click)="changeState(signInPageState.ENTER_EMAIL)" class="btn-primary" fill="clear">
      Sign in with email address
    </ion-button>

    <div class="sign-in__divider-container">
      <div class="sign-in__divider"></div>
      or
      <div class="sign-in__divider"></div>
    </div>

    <ion-button
      (click)="googleSignIn()"
      appFormButtonValidation
      [loading]="googleSignInLoading"
      class="sign-in--secondary-cta-btn"
      fill="clear"
    >
      <img class="sign-in--secondary-cta-btn-logo" src="../../../assets/svg/logo-google.svg" alt="fyle-logo" />
      Sign in with Google
    </ion-button>
  </div>
  <div class="sign-in__enter-email" *ngIf="currentStep === signInPageState.ENTER_EMAIL">
    <div>
      <ion-icon
        class="fy-icon sign-in__enter-email__back-icon"
        src="/assets/svg/arrow-tail-left.svg"
        (click)="goToEnterPasswordStep()"
      ></ion-icon>
      <div class="sign-in__enter-email__form-container">
        <div>
          <div class="sign-in__enter-email__page-header">Sign in</div>
          <div class="sign-in__enter-email__sub-header">Enter the credentials to access your account</div>
        </div>
        <form [formGroup]="fg" class="sign-in__enter-email__input-container">
          <div class="sign-in__enter-email__input-container__label">Registered email</div>
          <input
            #simpleEmailInput
            matInput
            type="email"
            placeholder="Enter registered email"
            formControlName="email"
            pattern="\S+@\S+\.\S{2,}"
            class="sign-in__enter-email__input-container__input"
          />
          <div
            class="sign-in__enter-email__error-message"
            *ngIf="fg.controls.email.touched && !fg.controls.email.valid"
          >
            Please enter a valid email.
          </div>
        </form>
      </div>
    </div>
    <div>
      <ion-button
        class="btn-primary"
        fill="clear"
        [disabled]="!fg.controls.email.valid"
        (click)="checkIfEmailExists()"
        appFormButtonValidation
        [loading]="emailLoading"
        [loadingText]="'Continue'"
      >
        Continue
      </ion-button>
    </div>
  </div>
  <div class="sign-in__enter-password" *ngIf="currentStep === signInPageState.ENTER_PASSWORD">
    <div>
      <ion-icon
        class="fy-icon sign-in__enter-email__back-icon"
        src="/assets/svg/arrow-tail-left.svg"
        (click)="changeState(signInPageState.ENTER_EMAIL)"
      ></ion-icon>
      <div class="sign-in__enter-password__form-container">
        <div>
          <div class="sign-in__enter-password__page-header">Sign in</div>
          <div class="sign-in__enter-password__sub-header">Enter the credentials to access your account</div>
        </div>
        <form [formGroup]="fg" class="sign-in__enter-password__input-container">
          <div class="sign-in__enter-password__input-container__label">Registered email</div>
          <div class="sign-in__enter-password__disabled-email">
            {{fg.controls.email.value}}
            <ion-icon
              [src]="'/assets/svg/edit.svg'"
              (click)="changeState(signInPageState.ENTER_EMAIL)"
              class="sign-in__enter-password__email-edit"
            ></ion-icon>
          </div>
          <div
            class="sign-in__enter-password__text sign-in__enter-password__text-block"
            [ngClass]="{'sign-in__enter-password__text__invalid': fg.controls.password.touched && !fg.controls.password.valid}"
          >
            <div class="sign-in__enter-password__input-container__label">Password</div>
            <div class="sign-in__enter-password__password-container">
              <input
                placeholder="Re-enter password"
                [required]="true"
                [type]="hidePassword ? 'password': 'text'"
                class="sign-in__enter-password__text-input smartlook-show"
                formControlName="password"
              />
              <div
                class="sign-in__enter-password__password-icon-container"
                matSuffix
                (click)="hidePassword = !hidePassword"
              >
                <ion-icon
                  class="fy-icon sign-in__enter-password__password-icon"
                  src="{{hidePassword ? '/assets/svg/eye-slash.svg' : '/assets/svg/eye.svg'}}"
                ></ion-icon>
              </div>
            </div>
          </div>
          <div
            class="sign-in__enter-password__error-message"
            *ngIf="fg.controls.password.touched && !fg.controls.password.valid"
          >
            Please enter password
          </div>
        </form>
      </div>
    </div>
    <div>
      <ion-button
        class="btn-primary"
        fill="clear"
        [disabled]="!fg.controls.password.valid"
        (click)="signInUser()"
        appFormButtonValidation
        [loading]="passwordLoading"
        [loadingText]="'Signing In'"
      >
        Sign in
      </ion-button>
    </div>
  </div>
</ion-content>
